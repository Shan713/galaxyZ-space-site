{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="GalaxyZ Course Highlight">
  <title>{{ course.title }} - GalaxyZ Space</title>

  <link rel="stylesheet" href="{% static 'styles/main.css' %}" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Space+Grotesk:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    body {
      color: white;
    }

    .container {
      max-width: 1000px;
      margin: 40px auto;
      padding: 30px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      backdrop-filter: blur(10px);
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.1);
    }

    .course-header {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      align-items: center;
    }

    .poster {
      flex: 1.3;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .poster img {
      max-width: 450px;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
    }

    .details {
      flex: 2;
      text-align: right;
    }

    .details h1 {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    .details p {
      margin: 0.5rem 0;
    }

    .section {
      margin-top: 30px;
    }

    .video-section {
      margin-top: 40px;
    }

    .video-section iframe {
      width: 100%;
      height: 400px;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.15);
    }

    .logo-wrapper {
      width: 100%;
      display: flex;
      justify-content: center;
      margin-top: 60px;
    }

    .logo-wrapper img {
      max-width: 150px;
      height: auto;
    }

    #testimonials {
      margin-top: 30px;
    }
    .video-lock-wrapper {
  position: relative;
  cursor: pointer;
}

.video-lock-wrapper iframe {
  width: 100%;
  height: 400px;
  border-radius: 12px;
}

.locked-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 400px;
  border-radius: 12px;
  background: rgba(0, 0, 0, 0.6);
  color: white;
  font-size: 1.2rem;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.locked-overlay i {
  font-size: 2rem;
  margin-bottom: 0.5rem;
}

  </style>
</head>

<body>
  <div class="space-background">
    <div class="stars"></div>
    <div class="twinkling"></div>
    <div class="shooting-stars"></div>
    <div class="nebula"></div>
  </div>

  <div class="logo-wrapper">
    <a href="{% url 'home' %}"><img src="{% static 'assets/frontmoving.png' %}" alt="Logo" /></a>
  </div>


  <div class="container">
    {% if messages %}
    {% for message in messages %}
      <p style="color: {% if message.tags == 'error' %}red{% else %}green{% endif %}; text-align:center;">
        {{ message }}
      </p>
    {% endfor %}
    {% endif %}<div class="course-header">
  <div class="poster">
    <img src="{{ course.poster.url }}" alt="{{ course.title }} Poster">
  </div>
  <div class="details">
    <h1>{{ course.title }}</h1>
    <p><strong>Instructor:</strong> {{ course.instructor }}</p>
    {% if is_enrolled %}
      <p style="color: green; font-weight: bold;">You are already enrolled in this course!</p>
    {% else %}
      <div class="card-footer" style="font-size: 20px; font-weight: bold; color: #4FFF70;">
        {% if course.price == 0 %}
          <span style="text-decoration: line-through;">â‚¹299</span> FREE
        {% else %}
          â‚¹{{ course.price }}
        {% endif %}
        <br><br>
        <a href="{% url 'enroll_course' course.id %}" class="btn btn-glow">Register</a>
      </div>
    {% endif %}
  </div>
</div>


    <div class="section">
      <h3>ðŸ“˜ course Overview</h3>
      <p>{{ course.description }}</p>
    </div>

    {% if testimonials %}
    <section id="testimonials">
      <div class="section-header">
        <h2 class="section-title">What Participants <span class="text-gradient">Say</span></h2>
        <p class="section-subtitle">Words from our learners</p>
      </div>

      <div class="testimonial-container">
        <div class="testimonial-track" id="testimonial-track">
          {% for t in testimonials %}
          <blockquote class="testimonial">
            <div class="testimonial-quote">
              <i class="fas fa-quote-left"></i>
              <br>
              <p class="testimonial-text">{{ t.text }}</p>
              <i class="fas fa-quote-right"></i>
            </div>
            <footer class="testimonial-author">- {{ t.author }}</footer>
          </blockquote>
          {% endfor %}
        </div>

        <div class="testimonial-nav">
          <button class="testimonial-nav-btn" onclick="prevTestimonial()"><i class="fas fa-chevron-left"></i></button>
          <button class="testimonial-nav-btn" onclick="nextTestimonial()"><i class="fas fa-chevron-right"></i></button>
        </div>
      </div>
    </section>
    {% endif %}

    {% if course.courseVideoLink %}
<div class="video-section">
  <h3>ðŸŽ¥ Course Content</h3>

  {% if is_enrolled %}
    <iframe 
      src="{{ course.courseVideoLink }}" 
      title="{{ course.title }} Preview" 
      frameborder="0" 
      allowfullscreen>
    </iframe>

  {% else %}
    <div class="video-lock-wrapper" onclick="promptEnroll()">
      <iframe 
        src="{{ course.courseVideoLink }}" 
        title="Locked Preview" 
        frameborder="0" 
        allowfullscreen 
        style="filter: blur(8px); pointer-events: none;">
      </iframe>
      <div class="locked-overlay">
        <i class="fas fa-lock"></i>
        <p>This video is locked. Enroll to unlock full access!</p>
        <button class="btn btn-glow">Buy Course</button>
      </div>
    </div>
  {% endif %}
</div>
{% endif %}

  </div>

  <script>
    let currentTestimonial = 0;
    const track = document.getElementById('testimonial-track');
    const testimonials = document.querySelectorAll('.testimonial');

    function updateSlider() {
      track.style.transform = `translateX(-${currentTestimonial * 100}%)`;
    }

    function nextTestimonial() {
      currentTestimonial = (currentTestimonial + 1) % testimonials.length;
      updateSlider();
    }

    function prevTestimonial() {
      currentTestimonial = (currentTestimonial - 1 + testimonials.length) % testimonials.length;
      updateSlider();
    }
  </script>
  <script>
function promptEnroll() {
  if (confirm("This content is locked. Would you like to enroll in this course?")) {
    window.location.href = "{% url 'enroll_course' course.id %}";
  }
}
</script>

</body>
</html>
